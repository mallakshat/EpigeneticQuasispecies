This repository contains code and data for manuscript titled "Epigenetic variation can promote adaptation by smoothing rugged fitness landscapes", published in Proceedings of the Royal Society B. 
DOI: 10.1098/spb.2025.2619

The central tenet of this work is analyzing how epigenetic switching affects adaptation on fitness landscapes. This analysis has two critical aspects - 
First. generating landscapes which vary significantly in their ruggedness. We use two approaches to do this: 
1. Creating correlated fitness landscapes with a tunable degree of epistasis. The script to do this is "CreatingLandscapes_Main.R"
2. Creating uncorrelated fitness landscapes following the house of cards (HoC) model. The  script to do this is -  "CreatingLandscapes_HoC.R"

The focus of this work has been genotypes with 5 loci. However, the landscapes with more loci can be easily generated by changing the parameter L in either script mentioned above. The degree of ruggedness of the landscape (another critical feature in the work) can also be tuned by changing the strength of epistatic interactions in either script.

The second critical feature of this work, simulating adaptation With epigenetic changes. to do this, we use a Wright-Fisher (WF) model modified to include epigenetic effects and transitions. The script for simulations following this model is "WFmodel.R"

The outline of our analysis follows as such :
a) using one of the two ways to generate a large number of fitness landscapes, and
b) analyzing those landscapes using WFmodel.

The exact landscapes used in our work are - 
1. Correlated landscapes - "LandscapesAll.csv" included in MainText_Data.zip. This file contains a set of 1000 fitness landscapes generated using the epistatic model, and we use this set for all analysis linked to this model. 
2. HoC model - "HoC_SetOfAllLandscapes.csv" included in Supplementary_Data.zip. This file contains a set of 1000 fitness landscapes generated using the HoC model, and we use this set for all analysis linked to this model. 
In both datasets, each column denotes one landscape - specifically the set of fitness values for all 32 genotypes in that landscape. 

The specific data generated and used for our analysis is included in the MainText_Data.zip and Supplementary_Data.zip folders respectively, based on whether the dataset is used for figures in the main or supplementary text. The file names correspond to the figure they were used to make in the paper. For example, "Npeaks_vs_Rank_1A.csv" in the MainText_Data.zip folder refers to the data used to generate Fig1A. 

All scripts to generate and analyze the data and make figures are included in the MainText_Code.zip and Supplementary_Code.zip folders respectively, based on whether the code is used for figures in the main or supplementary text. For example, "EffectiveLandscapes_FigS6.R" in the Supplementary_Code.zip folder refers to the script used for the generating, analyzing, and making the plot associated with Fig S6 in the Supplementary Material. 
